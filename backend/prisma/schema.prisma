generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider          = "sqlserver"
  url               = env("DATABASE_URL")
  shadowDatabaseUrl = env("SHADOW_DATABASE_URL")
}

model Role {
  id               Int      @id @default(autoincrement())
  nama             String   @unique
  createdAt        DateTime @default(now())
  deskripsi        String?
  updatedAt        DateTime @default(now()) @updatedAt
  gajiPokokBulanan Float    @default(0, map: "DF_RolegajiPokokB_0B91BA14")
  users            User[]
}

model User {
  id               Int                @id @default(autoincrement())
  email            String             @unique
  nama             String
  password         String
  roleId           Int
  createdAt        DateTime           @default(now())
  gajiPerJam       Float              @default(0)
  updatedAt        DateTime           @default(now())
  absensi          Absensi[]
  jadwal           Jadwal[]
  laporanPemasukan LaporanPemasukan[]
  slipGaji         SlipGaji[]
  role             Role               @relation(fields: [roleId], references: [id])
}

model Jadwal {
  id           Int      @id @default(autoincrement())
  waktuMulai   DateTime
  waktuSelesai DateTime
  userId       Int
  user         User     @relation(fields: [userId], references: [id])
}

model Absensi {
  id              Int       @id @default(autoincrement())
  jamMasuk        DateTime  @default(now())
  jamKeluar       DateTime?
  userId          Int
  createdAt       DateTime  @default(now())
  jamKerja        Float     @default(0)
  jamMulaiShift   DateTime
  jamSelesaiShift DateTime
  menitTerlambat  Int       @default(0)
  potonganGaji    Float     @default(0)
  shift           String
  status          String    @default("Hadir")
  tanggal         DateTime  @default(now()) @db.Date
  totalGaji       Float     @default(0)
  updatedAt       DateTime  @default(now())
  user            User      @relation(fields: [userId], references: [id])
}

model SlipGaji {
  id              Int      @id(map: "PK_SlipGaji_3213E83F2B37C9E9") @default(autoincrement())
  bulan           Int
  tahun           Int
  gajiBulanan     Float
  bonusKehadiran  Float    @default(0, map: "DF_SlipGajibonusK_0F624AF8")
  bonusLainnya    Float    @default(0, map: "DF_SlipGajibonusL_10566F31")
  potonganAlpha   Float    @default(0, map: "DF_SlipGajipotong_114A936A")
  potonganTelat   Float    @default(0, map: "DF_SlipGajipotong_123EB7A3")
  potonganLainnya Float    @default(0, map: "DF_SlipGajipotong_1332DBDC")
  totalGajiKotor  Float
  totalPotongan   Float
  totalGajiBersih Float
  tanggalBayar    DateTime @default(now(), map: "DF_SlipGajitangga_14270015") @db.DateTime
  keterangan      String?  @db.NVarChar(500)
  userId          Int
  createdAt       DateTime @default(now(), map: "DF_SlipGajicreate_160F4887") @db.DateTime
  updatedAt       DateTime @default(now(), map: "DF_SlipGajiupdate_17036CC0") @updatedAt @db.DateTime
  user            User     @relation(fields: [userId], references: [id], onUpdate: NoAction, map: "FK_SlipGajiuserId_151B244E")

  @@unique([userId, bulan, tahun])
}

model LaporanPemasukan {
  id              Int      @id @default(autoincrement())
  jumlahPemasukan Float
  tanggalLaporan  DateTime
  shift           String
  userId          Int
  user            User     @relation(fields: [userId], references: [id])
}
